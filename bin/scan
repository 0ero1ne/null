#!/usr//bin/env python3
# nmap parser
# 0.8-b1
# parse the output from nmap and check the MAC address vendor

import subprocess
import socket
import sys
import requests
import time

# Logo
def logo():
    print("""\x1b[1;32m
                                  .::!!!!!!!:.
.!!!!!:.                        .:!!!!!!!!!!!!
~~~~!!!!!!.                 .:!!!!!!!!!UWWW$$$
    :$$NWX!!:           .:!!!!!!XUWW$$$$$$$$$P
    $$$$$##WX!:      .<!!!!UW$$$$"  $$$$$$$$#
    $$$$$  $$$UX   :!!UW$$$$$$$$$   4$$$$$*
    ^$$$B  $$$$\\     $$$$$$$$$$$$   d$$R"
      "*$bd$$$$      '*$$$$$$$$$$$o+#"
           ````          ```````
              \x1b[1;31mI see you...
""", end='\n')


# Get the local IP
def get_ip_address():
    # Get the IP through a socket
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    s.connect(("8.8.8.8", 80))
    return s.getsockname()[0]

# Main function
def main():
		ip=get_ip_address()
		subnet="24"

		logo()
		
		p = str(str(subprocess.Popen(
	                                	[r"sudo","nmap","-sn",ip+"/"+subnet],
	                                	stdout=subprocess.PIPE).communicate()
	                                	).split('\\n')).split('Nmap')[2:-2]
	
		print()

		for x in p:
			name = x.split(" ")[4]
			ip = x.split(" ")[5][1:-3]
			mac = x.split(" ")[13]
			nvendor = x.split("(")[3][:-5]
	
		
			print("\x1b[1;32mName:\x1b[1;33m",name+"\x1b[0m")
			print("\x1b[1;32mIP:\x1b[1;33m",ip+"\x1b[0m")
			print("\x1b[1;32mMAC:\x1b[1;33m",mac+"\x1b[0m")
			if len(sys.argv) > 1:
				vendor = requests.get("https://api.macvendors.com/"+mac)
				print("\x1b[1;32mVendor:\x1b[1;33m",vendor.text,"\n"+"\x1b[0m")
				time.sleep(1)
			else:
				print("\x1b[1;32mVendor:\x1b[1;33m",nvendor,"\n"+"\x1b[0m")


# Run program
main()